---
title: "Moscas Manova"
author: "Matheus"
date: "6 de novembro de 2017"
output: pdf_document
---

#Moscas

##Pacotes
```{r}
source("funcoes.R")
pacotes <- c("tidyverse",
             "magrittr",
             "gridExtra")
ipak(pacotes)
```
##Lendo Os Dados

```{r}

dados <- read.table("Dados/Moscas.txt")

nomes_COl <- c("Especie",
               "Comprimento da asa",
               "Largura da asa",
               "Comprimento do terceiro palpo",
               "Largura do terceiro palpo",
               "Comprimento do quarto palpo",
               "Comprimento do 12ºsegmento\n da antena",
               "Comprimento do 13ºsegmento\n da antena")


colnames(dados) <- c("Especie","CompAsa","LargAsa","Comp3Palpo",          "Larg3Palpo","Comp4Palpo","Comp12Antena","Comp13Antena")

Especie_chr <- function(x){
  if (x == 0)
    y <- "torrens"
  else
    y <- "carteri"
}
dados %<>% mutate( Especie_fct = 
                    factor(map_chr(Especie,Especie_chr)))


```


#Analise Descritiva

##Medidas Descritivas

```{r}
descritivas <- 
dados %>% select_if(.predicate = is.integer) %>% 
  gather(coluna,valores) %>% 
  group_by(Coluna = coluna) %>% 
  summarise_if(.predicate = function(x) is.numeric(x),
                  .funs = c(Media = "mean",
                     DP = "sd",
                     Var. = "var",
                     Minimo = "min",
                     CV =  "cv",
                     Mediana = "median",
                     Maximo = "max")) %>% 
  mutate_if(.predicate = is.numeric,funs(round(.,3)))
```


##Boxplots
```{r}
##criando funcao para facilitar a criação dos boxplots
boxplots_moscas <- function(coluna){
 qplot(dados$Especie_fct,coluna,geom = "boxplot") + labs(x = "Espécie") + theme_bw()
}

graficos <- apply(dados[,2:8],2,boxplots_moscas)

for(i in 1:7)
 graficos[[i]] <-  graficos[[i]] + labs(y = nomes_COl[i+1])
  
##print os boxplots
grid.arrange(graficos[[1]], graficos[[2]], 
             graficos[[3]], graficos[[4]])

grid.arrange(graficos[[5]], graficos[[6]], 
             graficos[[7]], 
            layout_matrix = rbind(c(1,1),c(2,3)))


```
##Histograma
```{r}
##criando funcao para facilitar a criação dos boxplots
hist_moscas <- function(coluna){
 qplot(coluna,geom = "histogram") + theme_bw()
}

graficos <- apply(dados[,2:8],2,hist_moscas)

for(i in 1:7)
 graficos[[i]] <-  graficos[[i]] + labs(x = nomes_COl[i+1],y = NULL)
  
##print os boxplots
grid.arrange(graficos[[1]], graficos[[2]], 
             graficos[[3]], graficos[[4]])

grid.arrange(graficos[[5]], graficos[[6]], 
             graficos[[7]], 
            layout_matrix = rbind(c(1,1),c(2,3)))
```

